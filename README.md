# Couse2-Alexnet
An assignment of 《Machine Learning》 Course. Using AlexNet to implement images classification based on Animals-10 dataset. Some results are shown as below: the pictrues of animals and their prediction results.

 |                                  |             |                                 |             |                                |             |
 |----------------------------------|-------------|---------------------------------|-------------|--------------------------------|-------------|
 | <img src="./pred/0000.jpg" height="100" /> | <img src="./pred/0001.jpg" height="100" /> | <img src="./pred/0002.jpg" height="100" /> | <img src="./pred/0003.jpg" height="100" /> |<img src="./pred/0004.jpg" height="100" /> | <img src="./pred/0005.jpg" height="100" /> |
 | Butterfly | Butterfly | Cat | Chicken | Cow | Dog |
 | <img src="./pred/0006.jpg" height="100" /> | <img src="./pred/0007.jpg" height="100" /> |<img src="./pred/0008.jpg" height="100" /> | <img src="./pred/0009.jpg" height="100" /> |<img src="./pred/0010.jpg" height="100" /> | <img src="./pred/0011.jpg" height="100" /> |
 | Dog | Elephant | Elephant | Sheep | Sheep | Spider |

## Dataset
* Download the Animals-10 dataset from https://jbox.sjtu.edu.cn/1/X1L5Rp, password: hwqw.
* Rename the image files to `class_num.jpg`. For an instance, 'Dog_21.jpg' is the 21st picture of dog category.
* Resize the images to (277,277).
* Merge all the folders to one in order to load dataset conveniently.
* Split one to `train` dataset and `test` dataset. Default is 0.8 to 0.2.

To implement last four steps, run:
```bash
python tools/process.py
```

## Train

**Environment:** Python3.8+Pytorch1.11+CUDA11.3

Train using the train dataset generated by last step. The parameters could be specified by yourself. The trained model will be saved to `/pkl` by default.
```bash
python tools/train.py --batch_size 200 --epoch 200
```

## Test
Test the accuracy of trained model using test dataset. The direction of dataset is set by default (absolute path).
```bash
python tools/test.py --test_dir /path/to/test/dataset/
```
When finishing training, using tensorboard to visulaize the Descending Loss Curve.
```bash
tensorboard --logdir '/path/to/logdir/'
```
An example is shown as below (Training epoch200, batch_size200).
![avatar](./docs/0.png)

## Predict
Predict an unknown picture (without label which is different from test). You should specify one picture in `img_dir`.
```bash
python tools/pred.py --img_dir /path/to/image/file/
```

## Pretrained Model
Download pretrained model (using GTX1650) directly.

| Parameter | Accuracy | time cost | url |
|-----------|----------|-----------|-----|
|epoch20, batch_size200 | 0.61 | 2h |https://drive.google.com/file/d/1gcNLOjU0FoYaiYHkq80AAbRM2qsqEyE2/view?usp=sharing|
|epoch200, batch_size200 | 0.65 | 4.7h |https://drive.google.com/file/d/1Z0SZWIFeOOn5VBO6iUN-dYsJfSzBEw1m/view?usp=sharing|